---
title: "Previsão do Tempo e Mercado Financeiro"
author: "Edison Fernando"
date: "2024-10-09"
output: html_document
---

```{r setup, include=FALSE}
# Definindo o mirror do CRAN
options(repos = c(CRAN = "https://cloud.r-project.org/"))








# Pacotes necessários
library(httr)
library(jsonlite)
library(plotly)

# API para cotação do Dólar
url_dolar <- "https://economia.awesomeapi.com.br/json/last/USD-BRL"
response_dolar <- GET(url_dolar)
dolar_data <- fromJSON(content(response_dolar, "text"))
dolar_value <- dolar_data$USDBRL$bid
cat("Cotação atual do Dólar: R$", dolar_value, "\n")

# API para previsão do tempo em Rio Grande
weather_url <- "https://api.open-meteo.com/v1/forecast?latitude=-32.03&longitude=-52.09&hourly=temperature_2m"
weather_response <- GET(weather_url)
weather_data <- fromJSON(content(weather_response, "text"))

# Temperaturas para as próximas horas
hourly_temps <- weather_data$hourly$temperature_2m[1:24]  # Pegando as próximas 24 horas
hours <- seq(1, 24)

# Criando gráfico de temperatura
temp_fig <- plot_ly(x = ~hours, y = ~hourly_temps, type = 'scatter', mode = 'lines+markers')
temp_fig <- temp_fig %>% layout(title = "Previsão de Temperatura nas Próximas 24 Horas",
                                xaxis = list(title = "Horas"),
                                yaxis = list(title = "Temperatura (°C)"))

temp_fig

# API para cotação do ouro
url_ouro <- "https://economia.awesomeapi.com.br/json/last/XAU-BRL"
response_ouro <- GET(url_ouro)
ouro_data <- fromJSON(content(response_ouro, "text"))
ouro_value <- ouro_data$XAUBRL$bid
cat("Cotação atual do Ouro: R$", ouro_value, "\n")

# Adicionando outros índices (IBOVESPA, IFIX, IPCA, etc.)
# Aqui você pode continuar com mais APIs ou scraping

# Criando gráfico para cotação do Dólar
data_dolar <- data.frame(dias = 1:7, valor_dolar = c(5.20, 5.25, 5.30, 5.35, 5.50, 5.45, 5.55))
fig_dolar <- plot_ly(data_dolar, x = ~dias, y = ~valor_dolar, type = 'scatter', mode = 'lines+markers')
fig_dolar <- fig_dolar %>% layout(title = "Cotação do Dólar nos Últimos 7 Dias",
                                  xaxis = list(title = "Dias"),
                                  yaxis = list(title = "Valor (R$)"))
fig_dolar









```{r}
# Exemplo de script para obter a cotação do dólar
library(httr)
library(jsonlite)
install.packages("plotly")
library(plotly)

# Usar uma API de cotação do dólar
url <- "https://economia.awesomeapi.com.br/json/last/USD-BRL"
response <- GET(url)
dolar_data <- fromJSON(content(response, "text"))

# Mostrar o valor do dólar
dolar_value <- dolar_data$USDBRL$bid
cat("Cotação atual do Dólar: R$", dolar_value)

# Previsão do tempo usando uma API de tempo
weather_url <- "https://api.open-meteo.com/v1/forecast?latitude=-32.03&longitude=-52.09&current_weather=true"
weather_response <- GET(weather_url)
weather_data <- fromJSON(content(weather_response, "text"))
cat("Temperatura atual em Rio Grande: ", weather_data$current_weather$temperature, "°C")



# Criando um gráfico de exemplo para o dólar
data <- data.frame(dias = 1:7, valor_dolar = c(5.20, 5.25, 5.30, 5.35, 5.50, 5.45, 5.55))

fig <- plot_ly(data, x = ~dias, y = ~valor_dolar, type = 'scatter', mode = 'lines+markers')
fig <- fig %>% layout(title = "Cotação do Dólar nos Últimos 7 Dias",
                      xaxis = list(title = "Dias"),
                      yaxis = list(title = "Valor (R$)"))

fig


